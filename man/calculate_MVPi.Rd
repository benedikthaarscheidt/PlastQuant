% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4.R
\name{calculate_MVPi}
\alias{calculate_MVPi}
\title{Calculate Multivariate Plasticity Index (MVPi)}
\usage{
calculate_MVPi(trait_data, env = NULL, n_axes = 1)
}
\arguments{
\item{trait_data}{A data frame, matrix, or numeric vector of phenotypic trait values (rows = samples).}

\item{env}{(Optional) A vector (numeric, character, or factor) of length equal to the number of rows
in `trait_data` indicating each sample's environment. If `NULL`, equidistant environments
(`1:nrow(trait_data)`) are assumed.}

\item{n_axes}{Integer â‰¥ 1 giving the number of principal component axes to retain from the PCA.}
}
\value{
A single numeric value: the mean Euclidean distance between all pairs of environment centroids
in the first `n_axes` PCA dimensions. Returns `NA` (with a warning) if fewer than two environments.
}
\description{
Computes the Multivariate Plasticity Index (MVPi) for a set of phenotypic traits by
performing PCA and measuring the average Euclidean distance between environment centroids
in the reduced-dimensional space. This quantifies overall plasticity across environments.
}
\examples{
# Example with explicit environments:
trait_data <- data.frame(
  Trait1 = c(1.2, 2.3, 1.9, 3.1, 2.0, 2.8),
  Trait2 = c(2.5, 3.0, 2.8, 3.6, 2.9, 3.3)
)
env <- factor(c(1, 1, 2, 2, 3, 3))
mvpi_value <- calculate_MVPi(trait_data, env, n_axes = 2)
print(mvpi_value)

# Example with no env vector (equidistant environments assumed):
mvpi_value2 <- calculate_MVPi(trait_data, n_axes = 2)
print(mvpi_value2)

}
