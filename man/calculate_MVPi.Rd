% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4.R
\name{calculate_MVPi}
\alias{calculate_MVPi}
\title{Calculate Multivariate Plasticity Index (MVPi)}
\usage{
calculate_MVPi(trait_data, env = NULL, n_axes = 1)
}
\arguments{
\item{trait_data}{A data structure (e.g., data frame, matrix, or numeric vector) containing phenotypic trait values.
Rows correspond to samples.}

\item{env}{Optional vector of environments (numeric, character, or factor) corresponding to each sample.
If not provided, the function assumes equidistant environments using \code{seq_len(nrow)}.}

\item{n_axes}{Integer specifying the number of PCA axes to retain.}
}
\value{
A numeric value representing the Multivariate Plasticity Index (MVPi).
}
\description{
This function calculates the Multivariate Plasticity Index (MVPi) for a set of phenotypic traits,
quantifying plasticity across environments by computing the average Euclidean distance between
the centroids of environments in a reduced-dimensional space. Dimensionality is reduced using PCA
via \code{prcomp}, retaining the first \code{n_axes} axes.
}
\details{
The formula is based on the average Euclidean distance between environment centroids:

\deqn{MVPi = \text{mean}\Big\{ \sqrt{\sum_{k=1}^{n\_axes} \big(c_{ik} - c_{jk}\big)^2} \Big\}_{i < j}}
}
\examples{
# Example with explicit environments:
trait_data <- data.frame(
  Trait1 = c(1.2, 2.3, 1.9, 3.1, 2.0, 2.8),
  Trait2 = c(2.5, 3.0, 2.8, 3.6, 2.9, 3.3)
)
env <- factor(c(1, 1, 2, 2, 3, 3))
mvpi_value <- calculate_MVPi(trait_data, env, n_axes = 2)
print(mvpi_value)

# Example without providing an environment vector (assumes equidistant environments):
mvpi_value <- calculate_MVPi(trait_data, n_axes = 2)
print(mvpi_value)

}
