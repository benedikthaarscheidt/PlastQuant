% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rn_generator_nonlinear.R
\name{simulate_nonlin_reaction_norms}
\alias{simulate_nonlin_reaction_norms}
\title{Simulate Nonlinear Reaction Norm Data for Multiple Patterns}
\usage{
simulate_nonlin_reaction_norms(
  num_genotypes = 20,
  replicates = 3,
  env_min = 1,
  env_max = 10,
  env_length = 50,
  var_offset = c(gaussian = 0.5, sinusoidal = 0.3, wave = 0.7),
  var_slope = c(gaussian = 0.1, sinusoidal = 0.05, wave = 0.15),
  correlation = c(gaussian = -0.5, sinusoidal = -0.3, wave = -0.7),
  outliers = "none",
  seed = 12,
  plot = TRUE,
  genotypes_per_plot = 3,
  plot_file = NULL,
  csv_dir = NULL
)
}
\arguments{
\item{num_genotypes}{Integer: number of genotypes to simulate (default 20).}

\item{replicates}{Integer: number of replicates per genotype (default 3).}

\item{env_min}{Numeric: minimum environment value (default 1).}

\item{env_max}{Numeric: maximum environment value (default 10).}

\item{env_length}{Integer: number of points along the environmental gradient (default 50).}

\item{var_offset}{Named numeric vector of length 3: variance of intercept random effect
for each norm type (default c(gaussian=0.5, sinusoidal=0.3, wave=0.7)).}

\item{var_slope}{Named numeric vector of length 3: variance of slope random effect
for each norm type (default c(gaussian=0.1, sinusoidal=0.05, wave=0.15)).}

\item{correlation}{Named numeric vector of length 3: correlation of random intercept and slope
for each norm type (default c(gaussian=-0.5, sinusoidal=-0.3, wave=-0.7)).}

\item{outliers}{Character: one of "none","positive","negative","both"
to inject a single outlier into the mother curve (default "none").}

\item{seed}{Integer: random seed for reproducibility (default 12).}

\item{plot}{Logical: whether to generate example plots (default TRUE).}

\item{genotypes_per_plot}{Integer: number of genotypes per example plot (default 3).}

\item{plot_file}{Character or NULL: filepath for combined PDF of plots. If NULL, no file written.}

\item{csv_dir}{Character or NULL: directory path to save CSV files. If NULL, no files written.}
}
\value{
A data.frame with all simulated observations (Genotype, Replicate,
        Environment, Trait, ReactionNorm, BaseShift, Slope, VarianceOffset,
        VarianceSlope, Covariance) is invisibly returned.
}
\description{
Generates synthetic nonlinear reaction norm data (Gaussian, Sinusoidal, Wave) for multiple
genotypes and replicates, optionally injects outliers, plots examples, and saves both
data and figures to disk.
}
\details{
- Three pattern functions are used:
  * Gaussian: amplitude * exp(-width*(env-center)^2)
  * Sinusoidal: amplitude * sin(frequency*env + phase)
  * Wave: amplitude * sin(frequency*(env-5)) * exp(-0.1*(env-5)^2)
- Random intercept/slope deviations are drawn via MASS::mvrnorm.
- Mother curves may receive a single outlier modification.
- Example plots are created via ggplot2 and optionally saved.
- CSVs for each pattern and combined data are optionally saved.
}
