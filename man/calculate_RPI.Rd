% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.R
\name{calculate_RPI}
\alias{calculate_RPI}
\title{Calculate the Relative Plasticity Index (RPI)}
\usage{
calculate_RPI(trait_values, env_values = NULL, env1 = NULL, env2 = NULL)
}
\arguments{
\item{trait_values}{A numeric vector of trait measurements.}

\item{env_values}{(Optional) A vector of the same length as \code{trait_values} giving the environment
label or value for each observation. If \code{NULL} (default), environments are assumed
equidistant (1, 2, â€¦, length(trait_values)).}

\item{env1}{(Optional) A single environment label or value. Must appear in \code{env_values}.
If provided together with \code{env2}, RPI is computed only for that pair.}

\item{env2}{(Optional) A single environment label or value. Must appear in \code{env_values}.
If provided together with \code{env1}, RPI is computed only for that pair.}
}
\value{
A single numeric value:
\itemize{
  \item If \code{env1} and \code{env2} are provided, returns the mean
    of \eqn{|x_{i,env1} - x_{i,env2}| / (x_{i,env1} + x_{i,env2})} over paired observations.
  \item Otherwise, returns the grand mean of RPI across all unique environment pairs.
}
Returns \code{NA} (with a warning) if fewer than two unique environments are present.
}
\description{
Computes the Relative Plasticity Index (RPI) of a trait across environments.
For two environments, RPI is defined as the mean of \eqn{|x_{i,1} - x_{i,2}| / (x_{i,1} + x_{i,2})}
over paired observations. When no specific pair is given, RPI is averaged over all unique
environment pairs.
}
\details{
1. Validates that \code{trait_values} is numeric and that \code{env_values} length matches.
2. If fewer than two unique environments exist, returns \code{NA}.
3. If \code{env1} and \code{env2} are specified, pairs up observations (up to the smaller group size)
   and computes RPI for that pair.
4. Otherwise, iterates over every combination of two distinct environments, computes pairwise RPI,
   and returns the average.
}
\examples{
# Two-environment example
trait <- c(5, 6, 7, 8, 9, 10)
env   <- rep(c("A", "B"), each = 3)
calculate_RPI(trait, env, env1 = "A", env2 = "B")

# Multi-environment example: averaged over all pairs
trait <- c(2, 4, 6, 8, 10, 12)
env   <- rep(1:3, each = 2)
calculate_RPI(trait, env)

# Equidistant environments assumed if env_values = NULL
calculate_RPI(c(1, 2, 3, 4))

}
