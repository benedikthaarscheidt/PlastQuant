% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/1.R
\name{calculate_grand_plasticity}
\alias{calculate_grand_plasticity}
\title{Calculate Grand Plasticity (Pi) for a Single Trait}
\usage{
calculate_grand_plasticity(
  trait_values,
  env_data,
  covariate_data = NULL,
  control_env = NULL
)
}
\arguments{
\item{trait_values}{Numeric vector of trait measurements for one genotype across environments.}

\item{env_data}{Factor or vector (same length as `trait_values`) indicating the environment
of each observation.}

\item{covariate_data}{Optional numeric vector (same length) to adjust for a covariate in the model.}

\item{control_env}{Optional level of `env_data` to treat as the control; that level's emmean will
be excluded when computing the CV.}
}
\value{
A single numeric value:
  \eqn{\mathrm{Pi} = \frac{\mathrm{sd}(\hat\mu_e)}{\mathrm{mean}(\hat\mu_e)},}
  where \(\hat\mu_e\) are the emmeans for each environment (minus any control_env).
}
\description{
Fits a linear model of a single trait on environment (and optional covariate),
obtains least‚Äêsquare means for each environment via **emmeans**, and then
computes the coefficient of variation (CV) of those means.  Optionally you
may exclude a control environment from the calculation.
}
\examples{
trait_values   <- c(10, 12, 20, 22)
env_data       <- factor(c(1,1,2,2))
covariate_data <- c(5, 6, 7, 8)

# Without covariate, include all envs
calculate_grand_plasticity(trait_values, env_data)

# With covariate, exclude "Control"
calculate_grand_plasticity(
  trait_values   = trait_values,
  env_data       = env_data,
  covariate_data = covariate_data,
  control_env    = "Control"
)

}
