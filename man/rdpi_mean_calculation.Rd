% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2.R
\name{rdpi_mean_calculation}
\alias{rdpi_mean_calculation}
\title{Calculate the Relative Distance Plasticity Index for Mean Phenotypic Values (RDPIs)}
\usage{
rdpi_mean_calculation(
  dataframe,
  trait_cols,
  sp = NULL,
  factors = NULL,
  factors_not_in_dataframe = NULL,
  stat_analysis = NULL
)
}
\arguments{
\item{dataframe}{A data frame containing the phenotypic data, including traits, genotype identifiers,
and environmental factors.}

\item{trait_cols}{A vector specifying the column indices or names of the traits to be analyzed.}

\item{sp}{(Optional) A column index or name indicating the species or genotype identifier. If not provided,
the data is treated as a single group.}

\item{factors}{(Optional) A vector of column indices or names specifying the internal environmental factors
within the data frame that should be combined to create unique environmental combinations.}

\item{factors_not_in_dataframe}{(Optional) A list of vectors representing external environmental factors
that are not included in the data frame. Each vector must have a length equal to the number of rows in the data frame.}
}
\value{
A list containing:
\item{all_results}{A list where each entry corresponds to a genotype (or species) and contains the RDPI values
and trait data for the specified traits.}
\item{trait_boxplots}{A ggplot object representing boxplots of trait values across environmental combinations.}
\item{anova_results}{A list of ANOVA summaries for each trait across the environmental combinations.}
\item{tukey_results}{A list of Tukey's HSD test results for each trait, assessing significant differences
between environmental combinations.}
}
\description{
This function calculates the Relative Distance Plasticity Index (RDPI) for mean phenotypic values.
RDPI is defined as the absolute phenotypic distance between the means of the same genotype
in different environments, divided by the smaller of the two mean phenotypic values.
}
\details{
The function is designed to handle multiple traits, genotypes, and environmental combinations,
providing a comprehensive analysis of phenotypic plasticity across environmental gradients.


The RDPI provides a measure of phenotypic plasticity by comparing the mean phenotypic values of the same genotype
across different environments. This metric is particularly useful for datasets with multiple environments and
genotypes, where it can reveal the degree of plasticity in response to environmental changes.

The function first combines internal and external environmental factors to create unique environmental
combinations. For each trait, it then calculates the absolute differences between the means of the trait across
all pairs of environments for the same genotype. These differences are normalized by dividing by the smaller of
the two means. The final RDPI value for each genotype is the average of these normalized differences across
all environment pairs.

ANOVA is performed on the trait data to assess the significance of the environmental factors, and Tukey's HSD test
is used to determine which specific environmental combinations differ significantly. The function also generates
boxplots to visualize the distribution of trait values across the different environmental combinations.
}
\examples{
# Example usage
df = data.frame(
  Genotype = rep(c("G1", "G2"), each = 6),
  Environment = rep(c("Env1", "Env2", "Env3"), times = 4),
  Height = c(10, 12, 11, 14, 16, 15, 20, 22, 21, 23, 25, 24)
)

# Calculate RDPIs for the 'Height' trait across genotypes and environments
results = rdpi_mean_calculation(
  dataframe = df,
  trait_cols = "Height",
  sp = "Genotype",
  factors = "Environment"
)

# Access the RDPI values and boxplots
print(results$all_results)
print(results$trait_boxplots)

}
