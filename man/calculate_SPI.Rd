% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4.R
\name{calculate_SPI}
\alias{calculate_SPI}
\title{Calculate Standardized Plasticity Index (SPI)}
\usage{
calculate_SPI(data, env_col, trait_cols, env1, env2, reference_env)
}
\arguments{
\item{data}{A data frame containing the observations.}

\item{env_col}{Either a column name or index in \code{data} that holds the environment labels, or an external
vector of length \code{nrow(data)} specifying the environment for each row.}

\item{trait_cols}{A character or numeric vector indicating which columns in \code{data} contain the trait measurements.}

\item{env1}{The label (value) of the first environment in \code{env_col} to compare.}

\item{env2}{The label (value) of the second environment in \code{env_col} to compare.}

\item{reference_env}{The label (value) of the reference environment in \code{env_col} whose standard deviation is used for scaling.}
}
\value{
A named numeric vector of SPI values, one entry for each trait in \code{trait_cols}.
}
\description{
Computes the Standardized Plasticity Index (SPI) for one or more traits by comparing trait
values between two environments and scaling the difference by the variability in a reference environment.

The index is defined as:
\deqn{SPI = \frac{\bar{x}_{env2} - \bar{x}_{env1}}{\mathrm{sd}(\,x_{ref}\,)},}
where \(\bar{x}_{env1}\) and \(\bar{x}_{env2}\) are the mean trait values in the two focal environments,
and \(\mathrm{sd}(x_{ref})\) is the standard deviation of trait values in the reference environment.
}
\examples{
df <- data.frame(
  Height = c(10, 12, 15, 18),
  Weight = c(5,  6,  7,  8),
  Env    = factor(c("A", "A", "B", "B"))
)
# Compute SPI comparing B vs. A, with A as the reference
calculate_SPI(
  data          = df,
  env_col       = "Env",
  trait_cols    = c("Height", "Weight"),
  env1          = "A",
  env2          = "B",
  reference_env = "A"
)

}
