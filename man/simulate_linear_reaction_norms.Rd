% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rn_generator_linear.R
\name{simulate_linear_reaction_norms}
\alias{simulate_linear_reaction_norms}
\title{Simulate and Save Synthetic Reaction Norm Data}
\usage{
simulate_linear_reaction_norms(
  num_genotypes = 20,
  individuals_per_genotype = 3,
  env_min = 1,
  env_max = 10,
  env_length = 50,
  VE = 1,
  VS = 0.2,
  rES = 1,
  outliers = "none",
  seed = 42,
  plot = TRUE,
  genotypes_per_plot = 5,
  plot_file = NULL,
  csv_file = NULL
)
}
\arguments{
\item{num_genotypes}{Integer: number of genotypes to simulate (default 20).}

\item{individuals_per_genotype}{Integer: number of replicates per genotype (default 3).}

\item{env_min}{Numeric: minimum environment value (default 1).}

\item{env_max}{Numeric: maximum environment value (default 10).}

\item{env_length}{Integer: number of points along the environmental gradient (default 50).}

\item{VE}{Numeric: variance of intercept random effect (default 1).}

\item{VS}{Numeric: variance of slope random effect (default 0.2).}

\item{rES}{Numeric: correlation between intercept and slope random effects (default 1).}

\item{outliers}{Character: one of "none", "positive", "negative", or "both" for outlier injection in fixed curve (default "none").}

\item{seed}{Integer: random seed for reproducibility (default 42).}

\item{plot}{Logical: whether to generate a ggplot of a random subset of genotypes (default TRUE).}

\item{genotypes_per_plot}{Integer: how many genotypes to include in the example plot (default 5).}

\item{plot_file}{Character or NULL: filepath to save the PDF plot (if `plot = TRUE`).  If NULL, no file is written (default NULL).}

\item{csv_file}{Character or NULL: filepath to save the synthetic data CSV.  If NULL, no file is written (default NULL).}
}
\value{
A data.frame with columns:
  * Genotype, Replicate, Environment, Trait, ReactionNorm,
    BaseShift, Slope, VarianceOffset, VarianceSlope, Covariance
Invisibly returns the data.frame.
}
\description{
Generates synthetic reaction norm data for multiple genotypes and replicates,
with optional outlier injection, plotting, and saving to disk.
}
\details{
- Builds a 2Ã—2 covariance matrix from VE, VS, rES.
  - Generates fixed (mother) curves and adds random slope/intercept deviations for replicates.
  - Optionally injects a single outlier into the fixed curve.
  - Optionally plots a random subset of genotypes and saves as PDF.
  - Optionally writes the full dataset to CSV.
}
