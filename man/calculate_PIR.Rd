% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/1.R
\name{calculate_PIR}
\alias{calculate_PIR}
\title{Phenotypic Instability Ratio (PIR)}
\usage{
calculate_PIR(trait_values, env_values = NULL, rgr_values = NULL)
}
\arguments{
\item{trait_values}{Numeric vector of trait measurements.}

\item{env_values}{Optional vector (numeric, character, or factor) of the same length as `trait_values`
indicating the environment for each measurement. If `NULL` (default), environments
are treated as equally spaced (1, 2, …).}

\item{rgr_values}{Optional numeric vector of relative growth rates corresponding to `trait_values`.
If `NULL` (default), RGR is estimated from successive differences in environment means.}
}
\value{
Single numeric PIR value.
}
\description{
Computes the Phenotypic Instability Ratio (PIR) for a trait measured across environments,
following Robinson (1989). PIR is defined as the difference between the maximum and minimum
mean trait values across environments, divided by the mean trait value in the environment
with the highest relative growth rate (RGR).
}
\details{
1. Convert or generate `env_values` into a factor.
2. Compute the mean trait value in each environment.
3. Determine `MaxMean` and `MinMean` from these environment means.
4. Obtain or estimate RGR per environment; identify the environment with maximum RGR.
5. Compute \eqn{\mathrm{PIR} = (MaxMean - MinMean) / Mean_{MaxRGR}}.
}
\examples{
trait_values <- c(
  10,12,11,13,14,15,13,14,12,13,
  20,22,21,23,24,25,23,24,22,23,
  30,32,31,33,34,35,33,34,32,33
)
env_values <- rep(c("Env1","Env2","Env3"), each = 10)
calculate_PIR(trait_values, env_values)

# Equidistant environments
calculate_PIR(trait_values)

}
\references{
Robinson, D. (1989). *Plasticity in plant growth and resource use as a trait for crop breeding*.
Field Crops Research, 11(2-3), 153–159.
}
